# Lab 1-1 实验报告
PB15111672 林郅琦

## 提交目录
Lab1-1.

## 实验分析
* 通过使用 ANTLR4 工具构造词法分析器
* 本词法分析器模拟类 C 语言 C1语言的词法分析构建
* 实验主要任务为构造C1语言的词法分析器，完善 c1recongnizer/grammar/C1Lexer.g4
* 设计测试示例将并将测试示例写入 test/test_cases/lexer 中
* 检验测试示例的正确性

## 实验设计
* 由于已经给出大部分输出记号，因此只需将输出记号对应的正则表达式完善并添加行注释记号和多行注释记号即可。
* 本实验设计难点在于行注释记号和多行注释记号的正则表达式判定，需要对 LRLF 和 LF 换行符记号做处理
* 对行注释记号的正则表达式处理：  (先处理//\n，在处理注释非空情况)
```
LineComment: ('//''\r'?'\n'|'//'(.)*? ~'\\''\r'?'\n') -> skip;
```

* 对多行注释记号的正则表达式处理:  
```
BlockComment: '/*' (.)*? '*/'->skip;
```

* 由上可以看出：对注释处理采用非贪婪正则表达式模式，其中`'\r'?'\n'`为对 LRLF 和 LF 换行符的特殊处理

## 实验测试示例
* 测试示例采用类 C 语言程序进行测试(函数无输入参数)
* 测试代码如下：
```
/* Test For C1Lexer
 * Author Zhiqilin
 * Last Update Time 17/9/2017
 */
void SimpleCal{
    int i /* test */= 1;
    /* I write 
     * blind 
     * **ly
     */
    int j = i;
    if(j!=i)
        j = i + 1;
    while(0); // this is a single\
    while loop
    int _hll = 0x12;
    /**/
}

void SimpleCal(int i, int j){
    i /* test */= 1;
    /* I write 
     * blind 
     * **ly
     */
    j = i;
    if(j!=i)
        j = i + 1;
}
```

## 实验测试输出结果
```
zhiqideMacBook-Pro:grammar zhiqilin$ grun C1Lexer tokens -tokens ../test/test_cases/lexer
[@0,73:76='void',<'void'>,5:0]
[@1,78:86='SimpleCal',<Identifier>,5:5]
[@2,87:87='{',<'{'>,5:14]
[@3,93:95='int',<'int'>,6:4]
[@4,97:97='i',<Identifier>,6:8]
[@5,109:109='=',<'='>,6:20]
[@6,111:111='1',<Number>,6:22]
[@7,112:112=';',<';'>,6:23]
[@8,168:170='int',<'int'>,11:4]
[@9,172:172='j',<Identifier>,11:8]
[@10,174:174='=',<'='>,11:10]
[@11,176:176='i',<Identifier>,11:12]
[@12,177:177=';',<';'>,11:13]
[@13,183:184='if',<'if'>,12:4]
[@14,185:185='(',<'('>,12:6]
[@15,186:186='j',<Identifier>,12:7]
[@16,187:188='!=',<'!='>,12:8]
[@17,189:189='i',<Identifier>,12:10]
[@18,190:190=')',<')'>,12:11]
[@19,200:200='j',<Identifier>,13:8]
[@20,202:202='=',<'='>,13:10]
[@21,204:204='i',<Identifier>,13:12]
[@22,206:206='+',<'+'>,13:14]
[@23,208:208='1',<Number>,13:16]
[@24,209:209=';',<';'>,13:17]
[@25,215:219='while',<'while'>,14:4]
[@26,220:220='(',<'('>,14:9]
[@27,221:221='0',<Number>,14:10]
[@28,222:222=')',<')'>,14:11]
[@29,223:223=';',<';'>,14:12]
[@30,265:267='int',<'int'>,16:4]
[@31,269:272='_hll',<Identifier>,16:8]
[@32,274:274='=',<'='>,16:13]
[@33,276:279='0x12',<Number>,16:15]
[@34,280:280=';',<';'>,16:19]
[@35,291:291='}',<'}'>,18:0]
[@36,294:297='void',<'void'>,20:0]
[@37,299:307='SimpleCal',<Identifier>,20:5]
[@38,308:308='(',<'('>,20:14]
[@39,309:311='int',<'int'>,20:15]
[@40,313:313='i',<Identifier>,20:19]
[@41,314:314=',',<','>,20:20]
[@42,316:318='int',<'int'>,20:22]
[@43,320:320='j',<Identifier>,20:26]
[@44,321:321=')',<')'>,20:27]
[@45,322:322='{',<'{'>,20:28]
[@46,328:328='i',<Identifier>,21:4]
[@47,340:340='=',<'='>,21:16]
[@48,342:342='1',<Number>,21:18]
[@49,343:343=';',<';'>,21:19]
[@50,399:399='j',<Identifier>,26:4]
[@51,401:401='=',<'='>,26:6]
[@52,403:403='i',<Identifier>,26:8]
[@53,404:404=';',<';'>,26:9]
[@54,410:411='if',<'if'>,27:4]
[@55,412:412='(',<'('>,27:6]
[@56,413:413='j',<Identifier>,27:7]
[@57,414:415='!=',<'!='>,27:8]
[@58,416:416='i',<Identifier>,27:10]
[@59,417:417=')',<')'>,27:11]
[@60,427:427='j',<Identifier>,28:8]
[@61,429:429='=',<'='>,28:10]
[@62,431:431='i',<Identifier>,28:12]
[@63,433:433='+',<'+'>,28:14]
[@64,435:435='1',<Number>,28:16]
[@65,436:436=';',<';'>,28:17]
[@66,438:438='}',<'}'>,29:0]
[@67,441:443='int',<'int'>,31:0]
[@68,445:445='i',<Identifier>,31:4]
[@69,447:447='=',<'='>,31:6]
[@70,449:449='1',<Number>,31:8]
[@71,450:450=';',<';'>,31:9]
[@72,454:456='int',<'int'>,32:0]
[@73,458:458='j',<Identifier>,32:4]
[@74,459:459=';',<';'>,32:5]
[@75,461:460='<EOF>',<EOF>,33:0]
zhiqideMacBook-Pro:grammar zhiqilin$
```

## 测试结果分析
* 测试结果符合预期，对单行注释以及多行注释正则匹配符合预期。